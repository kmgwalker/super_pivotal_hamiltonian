%auto-ignore
%      this ensures the arxiv doesn't try to start TeXing here.
%!TEX root = super_lattice_models_draft.tex
%      prev line helps TeXShop do the right thing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{More on fermion condensation in modular tensor categories and the tube category} \label{more_on_tubes}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\dave{Should give a table of the conventions we use for an MTC somewhere
%e.g., normalizations on vertices, F-symbols, R-symobls and $\bar{\mcc}$.
%Maybe we don't need this.}

In this section we investigate $\tube(\mcc/\psi)$ when $\mcc$ is a modular tensor category.
%In this section we investigate the construction of the fermionic tube category in more detail, 
%and demonstrate how the tube category of a fermionic phase $\tube(\mcc / \psi)$ is related to 
%the data of the parent phase $\mcc$. 
%Throughout this section, we will specify to the case where the parent (bosonic) theory $\mcc$
%is a modular tensor category (MTC).
If $\mcc$ is a MTC, it is a well known theorem that $\tube(\mcc) \cong \mcc \times \overline{\mcc}$ as braided tensor categories
(see for example Theorem 7.10 of \cite{muger2003b}). 
In the this section we will prove an analogous theorem for the super pivotal categories resulting from fermion condensation on MTCs.
Specifically, if $\mcc$ is a MTC we prove that 
\be \label{tube_theorem_teaser}
	\tube(\mcc/\psi) \cong \mcc \times \overline{\mcc/\psi}
\ee 
as tensor categories.
(Neither side of this equivalence is braided in the usual sense.)
%so an equivalence of tensor categories is the best we can hope for.
%\footnote{However, 
%both sides are vortex-braided in the sense of subsection \ref{xxxxx}, and the isomorphism we construct
%is compatible with the vortex-braided on both sides.
%But in this paper we will content ourselves with proving the only the tensor equivalence.
%\kw{Dave, is this claim about vortex-braiding true?
%If we are not sure it is true then we should delete this footnote.}
%%\dave{I think there is a consistent braiding we can define on both sides.
%%I will try to see if there is something concrete to say.}
%\dave{Given the subtleties, maybe it's best not to speculate.
%We can do it in the follow up paper.
%Although I'm confused by the following:
%$E_6 = A_{11}/\mca$, where $\mca = 1 \oplus 7$.
%I was pretty sure that we showed $\tube(E_6) \cong \tube(A_{11}/\mca) \cong A_{11} \times A_{11}/\mca$ 
%as tensor categories.
%I was under the impression that $E_6$ cannot be braided, which makes the following result of \cite{kawahigashi2001} (cor 4.9) confusing:  $\tube(E_6) \cong A_{11} \times A_3$. 
%I could have mis-interpreted. 
%Would like to go back.}}

The analogous result when $\psi$ is a boson is a special case of Corollary 4.8 of \cite{kawahigashi2001}
%\kw{B\"ockenhauer-Eveans-Kawahigashi, Cor. 4.8, Publ RIMS, Kyoto Univ. 37 (2001) 1-35}
(see also the 1998 announcement by Ocneaunu referred to therein).

To begin, we remind the reader of this known result for $\tube(\mcc)$.
We then turn our attention to super pivotal categories of the form $\tube(\mcc/\psi)$ and make the necessary modifications.

%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{$\omega$ loops}
%%%%%%%%%%%%%%%%%%%%%%%%%%

An essential tool in what follows will be the the $\omega$ loop \cite{Lins1994}.
We take $\mcc$ to be a MTC and $\sob(\mcc)$ 
%\kw{I know I used this notation, but I think we should come up with something better.
%Maybe define a macro and use it consistently throughout the paper.}
%\dave{Lets just make it a command, that way we can change it more easily later.
%I chose $\sob(\mcc)$ = list of representatives of simple objects and 
%$\sobi(\mcc)$ = list of simple objects (i.e., representative + isomorphism class)}
%\kw{I don't understand the difference between $\sob$ and $\sobi$}
%\dave{$\sob(\mcc)$ is a set of representatives of the isomorphism classes of simple objects (e.g., $\sob(\tube(C_2)) = m_\unit, m_\sigma^+, m_\psi,\cdots$), while $\sobi(\mcc)$ is a set of all simple objects (e.g., $\sobi(\tube(C_2)) = m_\unit, m_\sigma^+,m_\sigma^-, m_\psi,\cdots$)}
%\ethan{I think that we can just use sObj or something, without the subscript. We do this in other parts 
%of the paper, and in a few of them mention that technically, by sObj we mean a fixed set of our 
%favorite representative simple objects}
%\dave{I think at one point in the following subsections we use both, 
%since we want to include all diagrams of the parent theory into the condensed one.}
be the set of the simple objects of $\mcc$. 
The $\omega$ loop is defined by
\begin{align}
	\omega  = \frac{1}{\mathcal{D}^2}\sum_{x\in \sob(\mcc)} d_x \cdot \text{cl}(x) ,
\label{omega_loop}
\end{align}
where as before, $\text{cl}(x)$ denotes a closed loop labeled by $x$, i.e.\ the closure of $x$ inside a solid torus.

One way to think of the $\omega$ loop is as follows.
In any premodular category,
string nets in the solid torus (with the empty boundary condition) form a semisimple commutative algebra
(isomorphic to the fusion ring of the premodular category).
Therefore this vector space has a basis given by the minimal idempotents of the algebra structure.
%Since the $S$-matrix in any modular theory is invertible by definition,
The $S$-matrix gives a bijection between these idempotents and $\sob(\mcc)$.
The $\omega$ loop is the minimal idempotent in the solid torus corresponding to the trivial object of $\mcc$.

Diagrammatically, we will denote the $\omega$ loop embedded in an ambient 3-manifold by
\begin{align}
\OmegaLoopx{\omega} = \frac{1}{\mcd^2}\sum_{x\in \sob(\mcc)} d_x\; \LoopArrowx{x} ,
\end{align}
where the gray disk in the center 
indicates that this relation holds in the solid torus.
%represents a cycle that the $\omega$ loop wraps around. 
If the gray region is empty (i.e.\ if the solid torus is standardly embedded in the 3-ball), 
then the $\omega$ loop can be shrunk and evaluated using the rules of MTC (since in that case cl$(x)$ is equal to $d_x$ times the empty diagram), 
and since $1 = \sum_x d_x^2/\mcd^2$, the $\omega$ loop simply acts as the identity. 
We summarize all the properties of the $\omega$ loop which we will make use of in Table~\ref{omega_loop_properties}.

For a modular theory, we can easily use part (a) of Table \ref{omega_loop_properties} to see that
\begin{align}
\OmegaLoopDefectx{\omega\;\;}{\omega\;\;} \quad \; =  \frac{1}{\mcd^2} \; \DiscGray.
\label{Omega_in_SLoop}
\end{align}
Note that this is true independent of what is inside the gray disc.
In the next section, we will see that this allows us to rewrite elements in the tube algebra in a particularly nice basis.
\begin{table}
\begin{center}{
\begin{flalign*} & \begin{array}{c @{\quad \quad  \quad  } c @{\quad \quad \quad } c }
			\text{(a)}	&	\text{(b)} &   \text{(c)}
		\\[1.0ex]
			\underset{x}{ \LoopOverId}{\scriptstyle{\omega}} = \delta_{x,\unit} \underset{x}{\Ida}
			&\scriptstyle{x}\;\IdxOmegaLoopa \;= \;\IdxOmegaLoopb\;\scriptstyle{x} 
			&	\HandleSlidea = \HandleSlideb
		\end{array} & \end{flalign*}
		}\end{center}
		\caption{\label{omega_loop_properties}
		All unlabeled lines in the above figures are $\omega$ loops as defined in \eqref{omega_loop}.
For a modular theory, the $\omega$ loop projects onto the vacuum as shown in part (a) (agreeing with the interpretation of $\omega$ as the minimal idempotent in the solid torus corresponding to the trivial object of $\mcc$).
Part (b) shows that arbitrary string-net lines can be deformed across any $\omega$ loop. 
Part(c) shows the same move as in part (b) but with an $\omega$ loop, 
rather than a single simple object $x$.  }
		
		\end{table}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Minimal idempotents of $\tube(\mcc)$, when $\mcc$ is a modular tensor category}   \label{mtc_idem_subsect}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The starting point for our proof of \eqref{tube_theorem_teaser} will be
a convenient set of minimal idempotents of $\tube(\mcc)$ \cite{ocneanu1994}. 
%To aid in our proof of the relation \eqref{tube_theorem_teaser}, it will behoove us to 
%work with a convenient presentation of the minimal idempotents of $\tube(\mcc)$ \cite{ocneanu1994}. 
We will give two constructions for complete sets of minimal idempotents of $\tube(\mcc)$:
one set is more conventional (and appeared first historically), while the second 
is more suited to the proof of \eqref{tube_theorem_teaser}.
%will allow us to prove \eqref{tube_theorem_teaser} more easily.

The first construction of a set of minimal idempotents utilizes annuli that possess only one marked point at each boundary.
A basis for the morphism space from $a$ to $b$ in 
the annular category $\tube(\mcc)$ is given by
\begin{align}
\text{mor}(\underset{a}{\TubeBCx{}} \rightarrow \underset{b}{\TubeBCx{}})=
\; \cc\left[ \TubeElementx{t}{a}{b} \right]\quad \quad \text{with} \quad \quad t \in \bigoplus_r V^{rb r^*}_a,
\end{align}
with $r$ in each summand labeling the string wrapping around the annulus. 
With the help of \eqref{Omega_in_SLoop} we can change to a much more convenient basis via
\begin{align}
\TubeBasisa \times \mcd^2 =  
\TubeBasisb   =
\TubeBasisc  = \sum_{\substack{x,y \in \sob(\mcc) \\
\mu =1,\cdots, N^{xy}_a \\
\nu =1,\cdots, N_{xy}^b}
}C_{t; xy\mu\nu} \times 
\TubeBasisd
\label{idempotent_complete}
\end{align}
where we have written the annulus as a rectangle with the left and right (blank) edges identified and
the indices $\mu$ and $\nu$ run over complete orthogonal bases of $V^{xy}_a$ and $V_{xy}^b$, respectively.
The constants $C_{t,xy\mu \nu}$ can be determined by fusing the $\omega$ loop into the strand labeled $b$ in the second to last diagram, 
and then using a series of $F$ and $R$ moves to reduce the diagram to the form of the final diagram on the right. 
Since $\mcc$ is assumed to be modular and all transformations shown 
above are invertible, we have shown that the morphism spaces can be alternatively presented as 
\begin{align}
\text{mor}(\underset{a}{\TubeBCx{}} \rightarrow \underset{b}{\TubeBCx{}})\cong \cc\left[ \TubeBasisd \right]. 
\label{AnnCatMTC}
\end{align}
Equivalently, we have shown that
\begin{align}
\text{mor}(\underset{a}{\TubeBCx{}} \rightarrow \underset{b}{\TubeBCx{}})\cong \bigoplus_{xy} V^{b}_{xy} \tp V^{xy}_a .
\label{morabMTC}
\end{align}
This basis for the morphism space of $\tube(\mcc)$ is rather special, and we will see that the diagonal elements (those with $a=b$) are proportional to the minimal idempotents.

Letting $\mu_i$, $i= 1, \cdots,N_{xy}^a$ be a basis of $V^{xy}_a$ and similarly letting $\nu_i$ be a basis for $V^{a}_{xy}$, we take the normalization convention 
\begin{align} \label{bubble_normalization} 
\VxyaoVxya = \delta_{ij} \frac{d_x d_y}{d_a} \idaprime.
\end{align}
It then follows that
\begin{align}
\Vxyxy\;  =\delta_{ij}\;  \idxy\; + \; \cdots, 
\end{align}
where the $+\dots$ represents diagrams that have a nontrivial string connecting the $x$ and $y$ strings (if admissible diagrams of such a form exist).
From the properties of the $\omega$ loop, we thus have 
\begin{align}
\Vxyxyomega \;=\delta_{ij}\; \idxy.
\label{vertex_normalization}
\end{align}
Our normalization is thus chosen so that there is no numerical prefactor in front of the right hand side 
of the above equality. 

With these conventions, we define a basis of morphisms by
\begin{align} \label{f_morphism_defn}
f_a^b(x,y,j,i)\; = \; \TubeBasisdprime,
\end{align}
where $\nu_j$ is a basis of $V_{xy}^b$ and $\mu_i$ a basis of $V^{xy}_a$, which are normalized according to \eqref{bubble_normalization}.
It follows that the $f_a^b$ morphisms compose as 
\begin{align}
f_a^b(x,y,j,i) \cdot f_b^c(x',y',j',i') = \delta_{xx'}\delta_{yy'} \delta_{ij'} f_a^c(x,y,j,i').
\label{matrix_units}
\end{align}
%\kw{with the  cdot notation for morphism composition, we write things in ``arrow" order (reverse of function order);
%need to make sure this is consistent throughout the paper.}
%\dave{
%I have been consistently doing the opposite:
%I was using $\cdot$ to mean stack the left tube on top of the right, 
%or in the case of the annulus, 
%stack the left inside of the right.
%I think all multiplication tables have been written this way (although some still have the $\times$ notation.
%Should we redefine the meaning of $\cdot$,
%make up a new notation for stacking, 
%or change tables?
%}
Therefore, the $f_a^b(x,y,j,i)$ is a basis of matrix units for $\tube(\mcc)$. 
Said another way,
$\tube(\mcc)$ 
(strictly speaking, the subcategory of $\tube(\mcc)$ spanned by objects with only a single marked point)
splits as a direct sum of full matrix categories\footnote{
Recall that a full matrix category is one in which each object is a finite-dimensional vector space,
and the morphisms between two objects are all linear maps.
A full matrix category with only one object is a full matrix algebra.
Full matrix categories are Morita trivial; all minimal idempotents within a full matrix category are equivalent to each other.
} 
labeled by pairs of simple objects in $\sob(\mcc) \times \sob(\mcc)$:
\begin{align}
\tube(\mcc) \cong \bigoplus_{xy} \text{Mat}(x,y),
\label{tube_matrix_algebra}
\end{align}
with the vector space associated to the object $a$ of $\tube(\mcc)$ at the $(x,y)$ summand being $V^a_{xy}$,
and 
\be
	\mor(a\to b) \cong \bigoplus_{x,y} \hom(V^a_{xy} \to V^b_{xy}) .
\ee
%where the matrix algebra is given by $\text{Mat}(x,y)\cong \bigoplus_{a,b} V^{b}_{xy} \boxtimes V^{xy}_a$ 
%(as before, $\boxtimes$ is the outer tensor product)\footnote{The multiplication in $\text{Mat}(x,y)$ is given 
%by $(\lambda^a_{xy} \boxtimes \lambda_b^{xy} )\cdot( \rho^b_{xy} \boxtimes \rho^{xy}_c) = 
%(\lambda^a_{xy}\boxtimes \rho^{xy}_c) \text{tr}\frac{\lambda^{xy}_b \circ \rho^b_{xy}}{d_x d_y}$, 
%where $\lambda_{xy}^a \in V_{xy}^a$ etc., and the trace is given by closing $x\tp y$ on the plane and evaluating the diagram.}.
%The $f_a^b(x,y,j,i)$ provide a basis for this simple matrix algebra \eqref{tube_matrix_algebra}.
It follows from \eqref{matrix_units} that the ``diagonal'' morphisms 
\begin{align} 
e(a,x,y,j) = f_a^a(x,y,j,j)
\label{idempotent_one_strand}
\end{align}
are each a minimal idempotent. 
The idempotents $e(a,x,y,i)$ and $e(b,x',y',j)$ are equivalent\footnote{Two idempotents 
$e$ and $e'$ are equivalent if $e = uv$ and $e' = vu$ for some $u$ and $v$.}
if and only if $x \cong x'$ and $y \cong y'$, with the isomorphism given by 
$e(a,x,y,i) = f_a^b(x,y,i,j) \cdot f_b^a(x,y,j,i)$ and $e(b,x,y,j) = f_b^a(x,y,j,i) \cdot f_a^b(x,y,i,j)$.
This presentation of the minimal idempotents also appeared in \cite{ocneanu1994}.



%\kw{Did Ocneanu draw diagrams like this for idempotents?  I thought this was something Dave made up.}
%\dave{It turns out he did -- in his talks, and then others wrote papers about them like the one I cited above (it's actually quite difficult to obtain that paper).
%I first found that formula in Mugers paper \cite{muger2003b} (I think section 6 or 7 -- when he's talking about the quantum double of an MTC).
%The one I made up was similar -- I was advertising as a ``modularity detector" last Fall. 
%I recently found out that a similar idempotent to that one had appeared in the literature before, see \cite{Fuchs2002} p.452 eq. 5.34.
%}




It will be useful to have another complete set of minimal idempotents for $\tube(\mcc)$ at our disposal. 
These are the minimal idempotents that live in the annular category with two marked points on each of the circles bounding the annulus (rather than one marked point on each circle).
The idempotents are given by
\begin{align}
e_{xy} = \TubeIdempotentTwoStrand.
\label{Bosonic_twostrand_idempotent}
\end{align}

To show that the $e_{xy}$ are a complete set of minimal idempotents, 
we first show that $e_{xy} \tube(\mcc) e_{x'y'}$
is zero unless $x=x'$ and $y=y'$, in which case it is 1-dimensional.
(This implies that the $e_{xy}$ are minimal and pairwise orthogonal.)
%we check their multiplication law: using the $\omega$ loop properties defined in Table \ref{omega_loop_properties}
%we see that $e_{xy} \cdot e_{x'y'} = \delta_{xx'} \delta_{yy'} e_{xy}$, and hence the $e_{xy}$ are orthogonal idempotents. 
%To show that the idempotents are minimal, we need to check that $e_{xy} \tube(\mcc) e_{xy}$ is one dimensional.
%\dave{I thought we were going to try and not say 'project' }
%(i.e. that the $e_{xy}$ project onto one-dimensional subspaces of $\tube(\mcc)$). 
Using the spine lemma,\footnote{
This is a well-known and easy-to-prove folk result which says that arbitrary string nets are 
equivalent to linear combinations of labeled spines.
We don't know a reference for this result. 
}
a basis for $e_{xy} \tube(\mcc) e_{x'y'}$ is spanned by
\begin{align}
\minimalBosonic \; = \; \minimalBosonicRHS.
\end{align}
%\kw{I think it would be clearer if the $p$ loop hung down and looked more like a tadpole
%(i.e.\ slide it over the lower omega, not the upper)}
%\dave{Yes, definitely.
%Much easier to draw as well.}
The RHS is derived from the LHS by first sliding the $p$ loop over the lower $\omega$ loop, then sliding the lower $\omega$ loop
over the upper $\omega$ loop.
The ``no tadpole" axiom implies that the diagram is zero unless $r\cong\unit$,
and (a) of Table \ref{omega_loop_properties} implies that $c$ (and hence also $c'$) must be $\unit$ in any non-zero diagram.
This proves the claim.

%First we note that $r \cong \unit$ if the diagram is to be nonzero due to the ``no tadpole'' theorem, and hence the line labeled by $p$ can be removed at the expense of multiplying the diagram by $d_p$. 
%The fact that $r \cong \unit$ means that $c \cong c'$, and by 
%using property (c) and then (a) of Table \ref{omega_loop_properties} we can slide 
%one of the $\omega$ loops around $c$ and conclude that $c \cong c' \cong \unit$. 
%Hence we are left with a single nonzero diagram, and we find that $e_{xy} \tube(\mcc) e_{xy}$ is indeed one dimensional.
%Before showing that the idempotents are complete, we first show that they are equivalent to the set of idempotents $e(a,x,y,j)$ defined above.

Completeness of the idempotents follows from the resolution of the identity 
\begin{align}
\mcd^2 \TubeCompletea =  \TubeCompleteb = \frac{1}{\mcd^2}\sum_{x,y,i} \sqrt{\frac{d_xd_y}{d_a}} \;  \TubeCompletecprime .
\end{align}
%where we have used the normalization $\nu_i \circ \mu_j = \delta_{ij} \sqrt{\frac{d_x d_y}{d_a}} \text{id}_a$.\footnote{
%This formula assumes the theory to be unitary; 
%if this weren't the case then a non-zero phase factor could enter in the coefficients of the summand.
%\kw{I'm confused -- isn't there already a non-zero phase factor in the summand?}
%}


It is easy to show directly that the idempotents $e_{xy}$ and $e(a,x,y,j)$ are equivalent.
Let
\begin{align}
\label{TwoStrandToOneStrand}
	g(b,x,y,j) =\; \gxyaj \quad \quad \text{and} \quad \quad h(a,x,y,i) = \; \hxyai .
\end{align}
Then we have
\be
	e_{xy} = g(a,x,y,j) \cdot h(a,x,y,j)
\ee
and
\be
	e(a,x,y,j) = h(a,x,y,j) \cdot g(a,x,y,j) .
\ee


The idempotents above can be used to show that $\tube(\mcc) \cong \mcc \times \overline{\mcc}$.
In the following subsection we will state and prove an analogous theorem for $\tube(\mcc/\psi)$.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Double of the fermionic quotient}
\label{double_fermionic_quotient}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this subsection we prove that $\tube(\mcc/\psi) \cong \mcc \times \overline{\mcc/\psi}$ as tensor categories
when $\psi$ is a fermion satisfying conditions of \ref{gntf_condense} and $\mcc$ is a modular tensor category.

To gain insights on the relation between $\tube(\mcc/\psi)$ and $\mcc$, 
we will first construct the minimal idempotents of the condensed theory, which are 
useful objects in their own right.
To facilitate this construction, we note that any string net configuration in the parent theory $\mcc$ descends to a string net configuration 
in the condensed theory $\mcc/\psi$.
Conversely, we can always take an even morphism in $\mcc/\psi$ and lift it to $\mcc$, 
giving us a way of lifting tubes in $\tube(\mcc/\psi)$ to those in $\tube(\mcc)$.
These two facts allow us to find the minimal idempotents of the quotient theory 
using knowledge of the minimal idempotents of the parent theory.
The details of the condensation functor $\tube(\mcc) \rightarrow \tube(\mcc/\psi)$ are important:
for example, the image of some of the idempotents may simply be zero, 
while the images of nonisomorphic idempotents of $\tube(\mcc)$ may map to the same isomorphism class in $\tube(\mcc/\psi)$. 
These details, as well as minimality and completeness of the idempotents, will have to be addressed carefully.
Once this is done, we arrive at the following theorem:

\begin{theorem}  \label{minimal_idempotents_modular_C/psi}
Let ${\mcc}$ be a modular tensor category and let $\psi$ be a fermion in ${\mcc}$ as in \ref{gntf_condense}.
Let $\mcc/\psi$ be the super pivotal category resulting from the fermionic quotient.
Let $\tube(\mcc/\psi) = \tube^B(\mcc/\psi) \cup \tube^N(\mcc/\psi)$
be the annular category of $\mcc/\psi$. 
Then as tensor categories,
\begin{align}
\tube(\mcc/\psi) \cong \mcc \times \overline{\mcc/\psi}.
\end{align}
In particular, $\sob(\tube(\mcc/\psi)) \cong \sob({\mcc}) \times \sob(\overline{\mcc/\psi})$. 
Let $a \in \sob(\mcc/\psi)$ and $\tilde{a} \in \sob({\mcc})$ be a lift of $a$.
If $\tilde a$ is transparent with respect to $\psi$, then $(x, a)$ is in the bounding sector $\tube^B(\mcc/\psi)$ of $\tube(\mcc/\psi)$
(for any $x\in\sob(\mcc)$).
If $\tilde a$ is not transparent with respect to $\psi$, then $(x, a)$ is in the non-bounding sector $\tube^N(\mcc/\psi)$.
% while
%$(x, a)$ is in the non-bounding sector otherwise.
\end{theorem}

The above result can also be written in terms of the tube category of the parent theory $\tube(\mcc)$. 
We first write 
$\mcc \times \bar\mcc/\psi \cong (\mcc/\unit)\times(\bar\mcc/\psi) \cong (\mcc\times\bar\mcc)/(\unit\times\psi)$.
Using the isomorphism $\tube(\mcc) \cong \mcc \times \bar\mcc$, we can embed 
$\psi \in \sob(\mcc)$ into $\tube(\mcc)$ by $\psi \mapsto \tilde\psi$, where $\tilde\psi \cong \unit \times \psi$. This means that as tensor categories, 
\be \tube(\mcc/\psi) \cong \tube(\mcc) / \tilde\psi,\ee
showing that fermion condensation commutes with constructing the tube category.


We prove the theorem by defining a tensor functor $E:\mcc \times \overline{\mcc/\psi} \rightarrow \tube(\mcc/\psi)$
and showing that it is an equivalence of tensor categories.
It is given by
\begin{align}
\xymatrix @!0 @M=2mm @R=15mm @C=48mm{
 &E: \; \; \mcc \times \overline{\mcc/\psi} \ar[r]            & \tube(\mcc/\psi) & \\
		  &\quad \quad  \;\; \left(\;  \EFunctora
\;,\;\EFunctorb \; \right)\;  \ar@{|->}[r] &\EFunctorc_{J(y)}&
		  },
		  \label{FunctorCxCtoTubeC}
\end{align}
where $J(y) = B$ if $\nu_y = 0$ and $J(y) = N$ if $\nu_y=1$, with $\nu_y$ the indicator 
defined in \eqref{grading}.
This is clearly a functor; it preserves composition of morphisms in an obvious way. 
To show that $E$ is a tensor isomorphism we need to show two things: 
\begin{enumerate} 
\item if $\{e_i \}$ and $\{f_j \}$ are a complete set of minimal idempotents for $\mcc $ and $ \overline{\mcc / \psi }$ respectively, 
then $\{ E(e_i, f_j) \}$ is a complete set of minimal 
idempotents for $\tube(\mcc/\psi)$,
\item  $E$ is a tensor functor. %so that $V^{e_i e_j}_{e_k} \tp V^{f_s f_t}_{f_w} \cong V^{E(e_i,f_s) E(e_j,f_t)}_{E(e_k,f_w)}$
\end{enumerate} 

We first establish that $\{ E(e_i, f_j) \}$ are a complete set of minimal idempotents for $\tube(\mcc/\psi)$.
This is done in three parts, first we show completeness, then that the idempotents are non-zero, 
and finally that they are minimal and orthogonal. 

A complete basis of morphisms for $\tube(\mcc/\psi)$ is given by
\begin{align}
% \mcd^2 \times \TubeBasisaF_J, 
 \TubeBasisaF_J, 
 \end{align}
%where the normalization $\mcd^2$ has been introduced for convenience. 
with $t$ an even morphism of $\tube(\mcc/\psi)$ and $\alpha \cong \unit$ or $\psi$ denotes whether the morphism of $\tube(\mcc/\psi)$ has even fermion parity or odd fermion parity.
\kw{I don't see where we used this convenient normalization.
\dave{It was convenient in \eqref{idempotent_complete}. 
But you're right, doesn't make much sense here. Lets remove it from the above equation and put it on the denominator of the RHS of the equation below 
(since that uses \eqref{idempotent_complete} which has this normalization).}}
An even parity tube ($\alpha \cong \unit$) has $ t \in \bigoplus_x V^{x b x^*}_{a} $ while and odd parity tube ($\alpha \cong \psi$) has $ t \in \bigoplus_x V^{x b x^*}_{a\tp \psi} $.
%If the tube has even fermion parity then 
%the label $\alpha$ is $\unit$ and $ t \in \bigoplus_x V^{x b x^*}_{a} $.
%If the tube has odd parity then 
%the label $\alpha$ is $\psi$ and $ t \in \bigoplus_x V^{x b x^*}_{a\tp \psi} $.
Since $t$ is an even morphism in $\tube(\mcc/\psi)$, 
we can (trivially) lift it to $\tube(\mcc)$,
use the completeness relation in \eqref{idempotent_complete}, and then (trivially) include the morphism back into $\tube(\mcc/\psi)$. 
Hence we have,
% and hence from \eqref{idempotent_complete} we have
% \begin{align}
%\mcd^2 \times \TubeBasisaF_J
 %=  
%\sum_{\substack{x,y \in \sob(\mcc) \\
%\nu \in V^b_{xy} \\
%\mu \in V^{xy}_{a \tp \alpha}}}
%C_{t; xy\mu\nu} \times 
%\TubeBasisdF_J
%\end{align}
 \begin{align}
\TubeBasisaF_J
 =  
\frac{1}{\mcd^2}\sum_{\substack{x,y \in \sob(\mcc) \\
\nu \in V^b_{xy} \\
\mu \in V^{xy}_{a \tp \alpha}}}
C_{t; xy\mu\nu} \times 
\TubeBasisdF_J.
\end{align}
for some coefficients $C_{t; xy \mu \nu}$.
The morphism on the right hand side of the equation is isomorphic to $E(x,y)$.
Making use of the fact that $E(x,y) \cong E(x, y \tp \psi)$,\footnote{Note that $E(x,y)$ is not isomorphic to $E(x \tp \psi, y)$, see \eqref{Etilde} for more details.} 
allows us to replace the sum over $y \in \sob(\mcc)$ by a sum over $y \in \sob(\mcc/\psi)$.
%In the above equation, either $y$ is a lift from $\mcc/\psi$, 
%or $y\tp \psi$ is a lift from $\mcc/\psi$ 
\kw{I'm confused by the ``lift" terminology.  Let's rephrase this.
\dave{I agree. I changed the sentence before and after, 
let me know if it is less confusing, or if it needs a more significant re-write/more details.
}}
%(equivalently, when we include $y$ into $\mcc/\psi$ it may be oddly isomorphic to its representative).
%It follows that we can write the pair $(x,y) \in \mcc \times \overline{\mcc}$ in the above equation as a pair $(x,y) \in \mcc \times \overline{\mcc/\psi}$ 
%after the possible insertion of two odd isomorphisms at the trivalent junctions.
Therefore, any morphism $t \in \tube(\mcc/\psi)$ can be written as
\begin{align} 
t = \sum_{k} x_k \cdot E(e_{i_k},f_{j_k} ) \cdot y_{k},
\end{align}
and hence the $\{ E(e_i, f_j) \}$ are complete. 

We now establish that the the set of idempotents $\{ E(e_i, f_j) \} $ are non-zero.
We do this using the trace defined Section \ref{traces_and_innerproducts}.
We have
\begin{align}
\tr \left ( E(x,y) \right) &= \tr \left( \TubeIdempotentTwoStrand_{J} \right) \\
%&= \frac{1}{\mcd^2} \sum_{r \in \mcc/\psi} \left( 1+s(J)(-1)^{\nu_y} \right) \frac{ d_r}{\dim \End(r)}  \tr \left( \IdempotentBasis_J \right)\\
&= \frac{1}{\mcd^2} \sum_{r \in \mcc}  d_r\;   \tr \left( \IdempotentBasis_J \right)\\
&  =\frac{1}{\mcd^2} (1+s(J)(-1)^{\nu_y} )d_x d_y. 
 %&=\frac{1}{\mcd^2}(1+ (-1)^{s(J)}(-1)^{\nu_y})d_x d_y 
\end{align}
\kw{I thought omega was the parent category omega??}
\dave{Ergh. Yes. Thanks!}
The second line follows from linearity of the trace and the last line from,
\begin{align}
\tr \left( \IdempotentBasis_J \right) &=  \tr_J   \left\{ \TubeIdempotentBasistrace : A\left( \DiskLarge \right)  \ra A\left( \DiskLarge\right)  \right \}\\
&= (\delta_{r \unit} + s(J) (-1)^{\nu_y}\delta_{r \psi} )d_x d_y. 
 \end{align} 
We have used that when $\text{cl}(\psi)$ is pushed past $y$ the trace picks up the phase $ (-1)^{ \nu_y}$.
%The second line follows from the first using 
%$\omega_{\mcc} =(\text{cl}(\unit) +\text{cl}(\psi))\cdot \omega_{\mcc/\psi}$, 
%and that $\text{cl}(\psi)$ can be removed at the compensation of the phase $s(J) (-1)^{ \nu_y}$.
%The last line follows from the definition of the trace,
%\begin{align}
%\tr \left( \TubeIdempotentTwoStrand_{J} \right) \\
%&= \frac{1}{\mcd^2} \sum_{r \in \mcc}\frac{ d_r}{\dim \End(r)}  \tr \left( \IdempotentBasis_J \right)\%\
%&  =\frac{1}{\mcd^2} (1+s(J)(-1)^{\nu_y} )d_x d_y 
 %&=\frac{1}{\mcd^2}(1+ (-1)^{s(J)}(-1)^{\nu_y})d_x d_y 
%\end{align}
%The second line follows from linearity of the trace and the last line from
%\begin{align}
%\tr \left( \IdempotentBasis_J \right) &=  \tr_J   \left\{ \TubeIdempotentBasistrace : \DiskLarge \ra \DiskLarge \right \}= (\delta_{r \unit} + s(J) (-1)^{\nu_y}\delta_{r \psi} )d_x d_y. 
% \end{align} 
See section \ref{traces_and_innerproducts} for more details on the trace.
%\begin{align}
%\tr \left( \IdempotentBasis_J \right) &=  \tr_J   \left\{ \TubeIdempotentBasistrace : \DiskLarge \ra \DiskLarge \right \}= \delta_{r \unit} d_x d_y. 
% \end{align} 
%where $r \in \mcc/\psi$ runs over a set of representatives of simple objects in $\mcc/\psi$.
Hence $\tr \left ( E(e_i,f_j) \right)$ is non-zero so long as $s(J) = (-1)^{\nu_{f_j}}$, 
which is true by definition of the $E$ idempotents (recall \eqref{FunctorCxCtoTubeC}).

Now we show that the $\{ E(e_i, f_j) \}$ are minimal. 
We do this by showing that $E(x,y) \cdot \tube(\mcc/\psi) \cdot E(x',y')$ is either one dimensional, in which case $E(x,y)$ is an m-type idempotent, 
or is isomorphic to $\cc^{1|1} $, in which case $E(x,y)$ a q-type idempotent.
\dave{Should we explain why this means that $E(e_i,f_j)$ is minimal?}
% is a simple algebra, i.e. 
%that it contains no nontrivial subalgebras. 
%\dave{I'm confused since we show that it can be isomorphic to $\cc^{0|1}$.
%How do we modify this to a correct statement?
%Before we had said `minimal if $f_{xy}^J \tube(\mcc/\psi) f_{xy}^J$ is one-dimensional', but I didn't like this either since $\cc^{1|1}$ is two dimensional.
%}
%\ethan{note to self: if you fix representatives in each class, you always get a simple algebra}
By the spine lemma, 
a generic element of $E(x,y) \cdot \tube(\mcc/\psi) \cdot E(x',y')$ can be written as
\begin{align}
\fTubefOdd \; = \;  \ftubefOddRHS,
\label{MinimalProof}
\end{align}
with $\delta \in V^{x}_{xc}, \; \rho \in V^{y\tp \alpha}_{c' y}, \; \sigma \in V^{cc'}_r, \; \kappa \in V^{pr}_p$ and we have suppressed the spin structure index (the spin structure is determined by $y$; 
recall \eqref{FunctorCxCtoTubeC}), 
with all vector spaces appearing being written in terms of the 
parent theory, $\mcc$, 
and $\alpha$ is either $\unit$ or $\psi$ denoting whether the tube is 
even or odd in $\tube^J(\mcc/\psi)$.
The no tadpole theorem guarenties that $r \cong \unit$ and consequently that $c \cong c'$, 
and that the loop traversing the annulus parallel to $\omega$ labeled $p$ can be removed at 
the expense of multiplying by its quantum dimension $d_p$.
Lastly, we can use property (c) of Table \ref{omega_loop_properties} to slide the lower $\omega$ 
loop around the line connecting $x$ and $y$ labeled by $c$ (which is isomorphic to $c'$ by the above).
Using property (a) of \ref{omega_loop_properties} we see that both $c \cong c' \cong \unit$.
If $\alpha \cong \psi$ then we require $y \tp \psi \cong y'$.
Using this and the orthogonality of the idempotents, we have
\begin{align}
\label{minimal_table}
E(x,y) \cdot \tube(\mcc/\psi) \cdot E(x',y') \cong
\begin{cases}
\cc^{1|0}& \text{if}\; x \cong x' \; \text{and}\; y \cong y' \\
\cc^{0|1}& \text{if}\; x \cong x' \; \text{and}\; y \cong \psi \tp y'  \\
\cc^{1|1}& \text{if}\; x\cong x' \; \text{and}\; y \cong y',\; y \cong y \tp \psi \\
0 & \text{otherwise}
\end{cases}
\end{align}
Hence, the $E(x,y)$ are minimal. 
This also confirms that $E(x,y)$ and $E(x,y \tp \psi)$ are oddly isomorphic, and
if $y \cong y\tp \psi$ then $E(x,y)$ has an odd endomorphism.

The tensor structure on $\tube(\mcc/\psi)$ is initially defined on $\text{Rep}(\tube(\mcc/\psi))$ and 
then transferred to $\tube(\mcc/\psi)$ using semisimplicity ($\tube(\mcc) \cong \text{Rep}(\tube(\mcc))$). 
Consequently, we only need to show that $E$ is a tensor functor on $\text{Rep}(\tube(\mcc/\psi))$.
To establish this, we show that
\begin{align} \label{fusion_isomorphism}
V^{E(a,x),E(b,y)}_{E(c,z)} \cong V^{ab}_c(\mcc) \tp V^{xy}_z(\mcc/\psi),
\end{align}
where $V(\mcc)$ denotes the fusion space for $\mcc$ and $V(\mcc/\psi)$ denotes the fusion space for $\mcc/\psi$.
This isomorphism is established by the following figure:
%\dave{Should I add a figure like we did for the other ones?}
%\dave{Did it anyway.}
\begin{align}
\FusionIsomorphismprime \; = \; 
\FusionIsomorphismprimereduced
\end{align}
%\begin{align}
%\FusionIsomorphism\FusionIsomorphism\FusionIsomorphism\FusionIsomorphism
%\end{align}
with $\alpha = \unit$ for the even fusion space and $\alpha = \psi$ for the odd fusion space.
By the spine lemma, the internal lines, labeled $k,h,r,s,t,u,v,p,q$ (multiplicity indices suppressed) span the entire space of 
net configurations for $V(P)$ with marked points, $(a,x)$, $(b,y)$, 
and $(c,z)$ living at the boundary circles (as before, $P$ is the pair of pants). 
Near each boundary circle we have applied the corresponding minimal idempotent to each boundary condition. 
Using the exact same arguments following \eqref{MinimalProof} we can simplify the diagram 
using the relations of Table ~\ref{omega_loop_properties} to find the diagram on the right. 
One finds that $r \cong s \cong t \cong u \cong v \cong \unit$, $k\cong x$, $h\cong b$, 
and the left over $p$ and $q$ loops can be removed by multiplying the picture with their quantum dimensions. 
The left over picture is isomorphic to $V^{ab}_c(\mcc) \tp V^{xy}_z(\mcc/\psi)$.

Since $E$ acts as a tensor functor on the elementary fusion spaces as in \eqref{fusion_isomorphism}, 
it acts as a tensor functor on arbitrary morphism spaces, 
establishing that $E$ is a tensor functor on $\text{Rep}(\tube(\mcc/\psi))$, 
and by semisimplicity also on $\tube(\mcc/\psi)$.

\dave{Is that sufficient to complete the proof? 
Do we need to say anything else? 
e.g., what the natural transformations are.}


%\dave{Old guess at natural transformation.}
%\begin{align}
%U_{X,Y}: \; E(X) \tp E(Y) \ra E(X \tp Y)
%\end{align}
%\begin{align}
%\Ufghk
%\end{align}

%\dave{
%Here is the hypothesis for what $\tube(\mcc/\psi)$ is when $\mcc$ is pre-modular due to a transparent fermion. 
%Let $\mcb$ be a minimal modular extension of $\mcc$, so that $\mcc \subset \mcb$ and $\text{dim}(\mcb) = 2 \text{dim}( \mcc) $. 
%Then as tensor categories 
%$$
%\tube(\mcc) \cong (\mcc/\psi \times \mcc/\psi) \cup ( \mcb'/\psi \times \mcb'/\psi )
%$$
%where $\mcb'$, is the set of particles that aren't transparent with respect to $\psi$.
%I will try to verify this at some point.
%}


\subsection{Modular transformations}
The explicit representation of the minimal idempotents allows us to compute the 
modular transformations for the condensed theory. 

%We again assume that $\mcc$ is a MTC. 
We first examine the $S$ transformation on bounding spin tori (i.e, the three spin 
tori that have at least one bounding cycle). 
%We first examine the $S$ transformation on a torus with a spin structure such that at least 
%one of the two cycles bears a bounding spin structure. 
The $S$ transformation acts to interchange the longitudinal and meridional cycles of the torus, and so it acts as
\begin{align}
S:\;\; \DCSmatrixa\; \mapsto \; \DCSmatrixb \;=\; \STorusBasisa
\label{s_transformation}
\end{align}
%\kw{Why the wiggle in the omega loop?  I think it would be better without it.}
%\dave{Sounds good. 
%Lemma 5.8 of \cite{muger2003b} was the reasoning. }
%In the last equality, we have introduced $\tilde{\omega} =\frac{1}{\mcd^2}\sum_x \kappa_x \text{cl}(x)$, 
%which satisfies $\omega \tp \tilde{\omega} = \tilde{\omega}$ and $\kappa_x$ is the Frobenius-Schur indicator.
%\kw{Why is this necessary?  I don't get it.}
In the first two pictures we have drawn 
the torus as an annulus with inner and outer boundaries identified, while in the last picture we have re-written 
the torus on the plane as a square with the top and bottom as well as left and right edges identified.
Additionally, recall that from the way we constructed the idempotents, 
if the spin structure along the azimuthal direction is bounding, then $b$
must be transparent with respect to $\psi$, and if the azimuthal spin structure is non-bounding, then $b$ must be non-transparent
with respect to $\psi$.
%Recall that the spin structure along the azimuthal direction is fixed by whether or not the label 
%$b$ below is transparent with respect to $\psi$. 
Since we are working with bounding spin tori, and since we always transform to the standard basis of idempotents, 
the spin structure can be inferred from context,
and so we will suppress the labels in some of the diagrams. 

We now need to perform a series of manipulations that returns the right hand side of \eqref{s_transformation} 
to a linear combination of pictures that are written in the standard basis (the same as the left 
hand side of \eqref{s_transformation} with the spin structures interchanged).
We first investigate the part of the diagram with the $a$ string and the $\omega$ loop:
\begin{align}
\frac{1}{\mcd^2} \; \Scalcaa 
\;=\; \Scalcab 
\;=\; \Scalcac
\;=\; \Scalcad
\;=\; \sum_{x\in \sob(\mcc)} \frac{1}{\mcd^2} \SMatrix{a}{x} \; \Scalcae
\label{Scalc_above}
\end{align}
We can now do the same for the $b$ loop,
%\begin{align}
%\frac{1}{\mcd^2}\; \Scalcba 
%\; = \; \Scalcbb
%\; = \; \Scalcbc
%\; = \; \Scalcbd
%\; = \; \sum_{y \in \sob(\mcc/\psi)} \frac{1}{\mcd^2} \SMatrixx{b^{*}}{y} \;  \Scalcbe
%\end{align}
\begin{align}
\label{ScalcBack}
\frac{1}{\mcd^2}\; \Scalcba 
\; = \; \Scalcbb
\; = \; \Scalcbc
\; = \; \Scalcbd
\; = \; \sum_{y \in \sob(\mcc)} \frac{1}{\mcd^2} \SMatrixx{b^{*}}{y} \;  \Scalcbe
\end{align}
where we have used that the $\omega$ loop is a projector onto the vacuum. 
In the last summation we need to replace $\sum_{y \in \sob(\mcc)}$ with $\sum_{y \in \sob(\mcc/\psi)}$:
%As with \eqref{...} this is accomplished by simultaneously letting $\text{cl}(y) \ra \text{cl}((y + y\tp\psi)/2^{n_x}$
\begin{align}
\label{interim_S_calc}
 \sum_{y \in \sob(\mcc)} \frac{1}{\mcd^2} \SMatrixx{b^{*}}{y} \;  \Scalcbe 
\; =\; \sum_{y \in \sob(\mcc/\psi)} \frac{1}{\mcd^2} \frac{1}{2^{n_y}}\left(  \SMatrixx{b^{*}}{y} \;  +s(J)\SMatrixxx{b^{*}}{y \tp \psi} \;  \quad  \right) \Scalcbe.
\end{align}
The factor of $s(J)$ appeared due to $\text{cl}_J(\psi \tp y) = s(J) \text{cl}_J (y)$, where the subscript $J$ means we close up $y$ around a cycle with spin structure $J$.
%\dave{Note to self: check if we use this notation earlier.}
The normalization factor $2^{-n_y} = 1/\dim \End(y)$ is inserted so that we don't over-weight the q-type simple objects from $\sob(\mcc)$ (recall for example, \eqref{dimCtoDimCpsi}). 
Using that $S_{b^* (y\tp \psi)} = (-1)^{\nu_b} S_{b^* y}$, and that $(-1)^{\nu_b} s(J) = 1$ by assumption, 
the right hand side of \eqref{interim_S_calc} can be simplified so that \eqref{ScalcBack} becomes
%\kw{this sentence is a bit garbled}
%\dave{Thanks. Brain had a glitch this morning. I think it's better now.}
\begin{align}
\frac{1}{\mcd^2}\; \Scalcba\; = \; \sum_{y \in \sob(\mcc/\psi)} \frac{2}{2^{n_y}} \frac{1}{\mcd^2} \SMatrixx{b^{*}}{y} \;  \Scalcbe 
\end{align}
Putting all calculations together, and removing leftover $\omega$ loops (which provide an 
additional factor of $\mcd^{-2}$) we find that the matrix elements of the (un-normalized) $S$-matrix can be written as
\begin{align}
\label{Smatrix_final_step}
\DCSmatrixb =  \sum_{\substack{x \in \sob(\mcc) \\ y \in \sob(\mcc/\psi) }} \frac{2}{2^{n_y}}S_{ax} S_{b^*y}  \; \DCSmatrixh.
\end{align}
In the above formula, the $S_{ax}$ and $S_{b^*y}$ are matrix elements of the $S$-matrix in the original 
input theory $\mcc$ (which we assumed to be an MTC).
Note that $\nu_b$ must be $0$ if $J$ is bounding, $1$ if $J$ is non-bounding, and similarly for $\nu_y$.
%Also note that we have assumed a fixed set of representatives of simple objects for $\mcc/\psi$, and $\mcc$. 
The simple object $y$ appearing in $S_{b^*y}$ on the right hand side of \eqref{Smatrix_final_step} is a trivial lift of the $y$ written in the closed up idempotent 
(recall that the first is a simple object of $\mcc$, while the latter is a simple object of $\mcc/\psi$).
%\dave{Kevin, is that bad form to use the same label for $y$ and the lift of $y$?}
%\kw{I think it's OK, since we define the objects of C/psi to the the objects of C.}
One can change the representative of the isomorphism class of $y \in \mcc/\psi$ with an odd isomorphism $\text{mor}(y \ra \psi \tp y)$.
%taking $y \ra \tilde{y} = \psi \tp y$. 
Under this odd isomorphism the right hand side of \eqref{Smatrix_final_step} picks up a factor of $s(J)(-1)^{\nu_b}$ which is equal to $1$ since $s(J(b)) = (-1)^{\nu_b}$.
%By assumption we have $s(J)(-1)^{\nu_b} = 1$, otherwise the closed up input idempotent is identically zero.
%which is always equal to $1$ (otherwise the input closed up idempotent is identically zero).

In order for the $S$-matrix to be unitary, we need to normalize each q-type idempotent properly.
%Recall that q-type idemopotents have a norm of $\sqrt{2}$, hence to find the normalized and unitary $S$-matrix we have to divide each q-type idempotent by $\sqrt{2}$.
In the discussion following \eqref{minimal_table} we pointed out that $E(a,b)$ is q-type if $b$ is q-type.
Hence we can normalize our idempotents by re-scaling the q-type idempotents by a factor of $1/\sqrt{2}$. This results in the ``pseudo idempotents'' 
\begin{align} 
\widehat{E}(a,b) = E(a,b)/(\sqrt{2})^{n_b},
\end{align}
which have unit norm.
The resulting unitary $S$-matrix is given by
%This results in a unitary $S$-matrix given by, 
%\dave{I will plug this into a computer and verify that it's unitary.}
%\dave{Currently having licensing issues with Mathematica, 
%will do this once that's resolved.}
%\dave{Appears to check out.}
%\dave{This was old notation}
%\begin{align}
%\text{cl}_W(f^{J}_{ab}) \xrightarrow{S^{JW \ra WJ}}  \sum_{\substack{x \in \sob(\mcc) \\ y \in \sob(\mcc/\psi) }} S_{ax}  S_{by}^*   \text{cl}_J(f^{W}_{xy})
%\end{align}
%\begin{align}
%\text{cl}_W(E(a,b)) \xrightarrow{S^{JW \ra WJ}}  \sum_{\substack{x \in \sob(\mcc) \\ y \in \sob(\mcc/\psi) }} S_{ax}  S_{by}^*   \text{cl}_J(E(x,y))
%\end{align}
\begin{align}
\label{normalized_S_matrix}
\text{cl}_W(\widehat{E}(a,b)) \xrightarrow{S^{JW \ra WJ}}  \sum_{\substack{x \in \sob(\mcc) \\ y \in \sob(\mcc/\psi) }} \frac{2}{(\sqrt{2})^{n_b+n_y}}S_{ax}  S_{b^*y}   \text{cl}_J(\widehat{E}(x,y))
\end{align}
%Recall that $\text{cl}_W(\widehat{E}(a,b))$ means 
%\kw{haven't we already defined $cl_W$?}
%\dave{I thought so, but can't find it. 
%Will leave the reminder for now, and reference to the appropriate place later.}
%we close the normalized idempotent $\widehat{E}(a,b)$ 
%\kw{hat means not an idempotent; could say ``pseudo-idempotent".}
%\dave{I think earlier we use the term `normalized idempotent'.
% we could say normalized pseudo-idempotent}
%with spin structure $J(b)$ 
%onto the torus with spin structure $W$ around the newly closed cycle. 
Note that $\text{cl}_J(\widehat{E}(x,y))$ on the right hand side of \eqref{normalized_S_matrix} is zero unless $y$ is compatible with the spin structure inherited from the left hand side of \eqref{normalized_S_matrix};
explicitly $y$ must satisfy $s(W) = (-1)^{\nu_y}$.
%, hence the sum over $y \in \sob(\mcc/\psi)$ in the righthand side of  should be restricted to those $y$ with $(-1)^{\nu_y} = s(W)$.
%Note, as discussed above, unless $J = J(b)$ and $W=W(y)$, the resulting vector is zero.
%\kw{$y$??}
%\ethan{right?}. 
%\dave{Yeap.}

%\dave{Ack. Sorry guys, made a transcription error from my notes.
%The last sum in the second part of the equation should be over $\sob(\mcc)$ not $\sob(\mcc/\psi)$. 
%Hopefully this clears things up, and addresses each of the points below.}

%\kw{what about $\sqrt 2$ normalization for q-type?}
%\dave{addressed}

%\kw{Need to also comment on how $S_{by}^*$ depends on choice of lift (or representative) of $y$}
%\dave{addressed}

%\kw{Should we explain the $*$ in $S_{by}^*$?}
%\dave{Changed it to $S_{b^*y}$. That's probably more clear anyway since that's what's written in the previous equation.}


The matrix elements of the $S$-matrix on the torus with non-bounding spin structure (periodic 
boundary conditions around both cycles) can be calculated in an analogous way.
The first half of the calculation remains the same as in \eqref{Scalc_above}.
The second half of the calculation changes only if $b$ is q-type, in which case the idempotent 
$E(a,b)$ is q-type, and has to be closed up on the torus with an odd endomorphism. 
As discussed in the caption of Figure \ref{C2Change_of_Basis}, closing an idempotent with an odd endomorphism always results in a sign ambiguity for the closed up idempotent.
In such a case we have
\footnote{We have used $(S^z)_{xy} = \frac{1}{\mcd} \Szmatrix$.}:
%\dave{Need to double check this, may have a mistake in the last step.}
%\ethan{why no $1/\mcd^2$ from the $\omega$ instead of $1/\mcd$ and why only the sum over stuff in $Q$?}
%\dave{Check the notes I sent and let me know if that clears it up, also if you agree with the calculation.}
%\begin{align}
%\frac{1}{\mcd^2} \;  \Scalcbadot \; = \; \Scalcbddot \; =\;  \frac{1}{\mcd} \sum_{y\in Q} \kappa_y [ S^{\psi} ]_{by}^*\Scalcbedot
%\end{align}
%\dave{Mention the sign ambiguity?}
%\kw{Probably yes}
\begin{align}
\frac{1}{\mcd^2} \; \Scalcbadotprime  \; = \;  \Scalcbddotprime \; =\;  \frac{1}{\mcd} \sum_{y\in Q}  [ S^{\psi} ]_{yb} \; \Scalcbedot
\end{align}

This completes our calculation of the $S$-matrix of the condensed theory in 
terms of the modular data of the input theory.  

\medskip

The $T$-matrix is found by twisting one boundary of an idempotent by $2\pi$ before closing it up. 
For the annulus, the twisting is implemented by performing a $2\pi$ counterclockwise rotation of the inner $S^1$ with respect to the outer $S^1$.
The matrix elements are given by
\begin{align}
\text{cl}_W(\widehat{E}(a,b)) \xrightarrow{\; \; \; T^{JW \ra J\widetilde{W}}\;\;\; } \theta_a \theta_b^* \text{cl}_{\widetilde{W}}(\widehat{E}(a,b))
\end{align}
where again $J = J(b)$, and where $\widetilde{W}$ can be read off from Figure \ref{spin_str_mapping_class_group}.
The phases $\theta_a$ and $\theta_b$ are the twists of the lifts of $a$ and $b$ to the parent theory.
Note that if $J = B$ then replacing $b$ with $b\tp \psi$ changes the sign of the twist.
This sign ambiguity is expected, since only $T^2$ has well-defined eigenvalues 
on idempotents (see the discussion near the beginning of Section \ref{C2_modular_mats}). 
\ethan{are we okay with this?}
\dave{I am.}


%%%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
\subsection{Minimal idempotents of $\tube(\mcc)$, when $\mcc$ is a super modular tensor category}
\dave{Agreed, lets punt this for now.}

\ethan{This was the part with the difficulty with transparent fermions and multiplicity stuff, 
right? Were we going to postpone this section until after v1? I think that might be smart}
\dave{Work in progress.}

\dave{I think it's easiest to assume a super-modular category and a minimal modular extension. 
Then $S_C = \tilde{s} \tp s_{sVec}$ with $\text{det} \tilde{s} \neq 0$. 
I think we could do something slightly more general but would require some work 
(i.e., understanding some known results, and checking the following intuition).
The idea is to use Lemma 3.3 of \cite{bruillard2017} (Arxiv version) and start with any pre-modular category $\mcb$.
Its Muger center is the representation category of $(G,z)$ for some $G$, 
and $z$ a central element of $G$ of order less than or equal to $2$.
We then ``de-equivariantize" $\mcb$ to find $\mcb_G$, which is a G-graded modular or 
super-modular tensor category (is this equivalent to a modular extension of $\mcb$?).
The intuition is that if $\mcb_G$ is modular, then $\tube(\mcb)\cong \cup_{g \in G} \mca_g\times \mca_{g^{-1}}$, 
where $\mca_g$ is the set of simple objects of $\mcb_G$ carrying label $g$ and the functor is given by the 1-stand idempotents.
If $\mcb_G$ is super-modular, then let $G_0$ be an index $2$ subgroup and $G_1 = G / G_0$. 
Then $\tube(\mcb) \cong (\cup_{g \in G_0} \mca_g \times \mca_{g^{-1}})  \cup (\cup_{g \in G_1} \mcv_g \times \mcv_{g^{-1}})$.
}

Here we extend the theorem~\ref{minimal_idempotents_modular_C/psi} to the case of super modular categories.
We use definition 3.1 of~\cite{bruillard2017},
A braided fusion category $\mcp$ is super modular if the Muger center $\mcz_2(\mcp) \cong \text{sVec}$.
Equivalently, the set of transparent sub-objects has one non-trivial object which is a fermion as defined in \ref{gntf_condense}.
Then we have the following theorem,
\begin{theorem}
Let ${\mcp}$ be a super modular tensor category and let $\psi$ be a fermion in ${\mcp}$ as in \ref{gntf_condense}.
Let $\mcc$ be a minimal modular extension of $\mcp$\dave{refer to somewhere.}.
Let $\mcc/\psi$ be the super pivotal category resulting from the fermionic quotient of the extension.
Let $\mca/\psi \subset \mcc/\psi$ be the set of simple objects that are transparent with respect to $\psi$, 
and $\mcv/\psi  \subset \mcc/\psi$ the set which are not transparent with respect to $\psi$.
Let
$
\tube(\mcp/\psi) = \tube^B(\mcp/\psi) \cup \tube^N(\mcp/\psi)
$
be the annular category of $\mcp/\psi$. 
Then as tensor categories,
\begin{align}
\tube(\mcp/\psi) \cong (\mca/\psi \times \overline{\mca/\psi}) \cup( \mcv/\psi \times \overline{\mcv/\psi}).
\end{align}
In particular, $\sob(\tube(\mcc/\psi)) \cong \sob({\mca/\psi}) \times \sob(\overline{\mca/\psi}) \cup  \sob({\mcv/\psi}) \times \sob(\overline{\mcv/\psi}) $. 
Let $a, \tilde{a} \in \sob(\mca/\psi)$, then $(a,\tilde{a})$ is in the 
bounding sector and if $a, \tilde{a} \in \mcv/\psi$ then $(a, \tilde{a})$ is in the non-bounding sector.
\label{minimal_idempotents_super_modular/psi}
\end{theorem}

Let $\mcc$ be a minimal modular extension of $\mcp$ as defined in \dave{Find appropriate references.}.
The objects of $\mcc$ are $\zt$ graded by how they braid with $\psi$. 
Denote $\mca = \mcp$ the objects of $\mcc$ which braid trivially with $\psi$, 
and $\mcv$ the objects of $\mcc$ that braid non-trivially with $\psi$.
Define the the $\omega$-loop of $\mca$ to be $\omega = \frac{1}{\mcd^2} \sum_{x \in \mca} d_x \text{cl}(x)$, with $\mcd^2 = \sum_{a \in \mca} d_a^2$. 

\dave{Stopping here for now.  
Need to re-evaluate how to write down these idempotents when $x,y \in \mcv$ are q-type. 
In this scenario, the $f_a^a(x,y,j,j)$ are not necessarily idempotent.
There is extra data coming from how a $\psi$ line is pulled past the fusion vertices $\mu_i$ and $\mu_j$. }

Consider the following set of morphisms for $\tube(\mcp/\psi)$,
\begin{align}
{f}_a^b(x,y,j,i) = \TubeBasisdprime_{J}, \quad \quad \text{with} \quad \quad \nu_x = \nu_y = J.
\end{align}
With $x,y \in \mca/\psi$ or $x,y \in \mcv/\psi$
and we used $\nu = 0(1)$ to denote $J= \text{bounding(non-bounding)}$ spin structures, 
and $\nu_j$, $\mu_i$ are normalized so that $\nu_j \circ \mu_i = \delta_{ij}\lambda^{F_{xy}^b F_a^{xy}} \frac{d_x d_y}{d_a} \text{id}_a$.
Where $F_{xy}^b$ and $F_a^{xy}$ are $0$, or $1$ denote the parity of the fusion vertices $\nu_j$ and $\mu_i$.
By fusing all strands into the annulus, we notice that ${f}_a^b(x,y,j,i)$ is not just a morphism of $\mcc/\psi$ but one of $\tube(\mcp/\psi)$ as well.

\begin{itemize}
\item If $x,y \in \mca$, then we have a complete set of matrix units for $\tube_B(\mcp/\psi)$. 
Proof is same as before. 
\item if $x,y \in \mcv$, and atleast one of them is not q-type, then we have a complete set of matrix units, proof is the same as before. 
Some of them are oddly isomorphic. 
\item if $x,y \in \mcv$ are both q-type, then the minimal idempotents we used before are no longer minimal, or orthogonal. 
Will work this out soon.
\end{itemize}

The $q$-type simple objects which may appear in $\mcc/\psi$ lead to linear relations on the $f_a^b(x,y,j,i)$ viewed as morphisms of $\tube(\mcp/\psi)$. 
In order to not over count these idempotents, we need to quotient by these linear relations.
If either $x$ or $y$ is a q-type simple object, then $\lambda f_a^b(x,y,j,i) = f_a^b(x,y,\tilde{j},\tilde{i})$,
where $\tilde{j}$ is found from $\nu_j$ by acting with an odd endomorphism from below, 
and $\tilde{i}$ is found from $\mu_i$ by acting with an odd endomorphism from above.
\dave{Will add pictures if we go this route.}


\dave{do this after proof.}
It was shown in \cite{bruillard2017}\dave{need to check this} that if there is one modular extension of $\mcp$, then there are 16 of them. 
Roughly speaking, the 16 different extensions are given by stacking with the Ising TQFT, 
and condensing the fermion coming from Ising paired with the fermion already present in the extension. 
A non-trivial check of the proof, is that the minimal idempotents are independant of the particular extension....


need to show:
\begin{itemize}
\item we have a minimal orthogonal and complete set of idempotents of $\tube(\mcp/\psi)$.
\item we have a tensor functor from $\mca/\psi \times \mca/\psi \cup \mcv / \psi \times \mcv /\psi \ra \tube(\mcc/\psi)$
\end{itemize}


\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%
